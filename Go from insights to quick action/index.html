<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Insights to Action</title>

  <!-- your existing CSS -->
  <link href="css/header_style.css"        rel="stylesheet"/>
  <link href="css/embed_area_style.css"    rel="stylesheet"/>
  <link href="css/dialog_send_coupon.css"  rel="stylesheet"/>
  <link href="css/dialog_success.css"      rel="stylesheet"/>
  <link href="css/dialog_campaign_list.css" rel="stylesheet"/>
<header id="contoso-header">
  <img src="img/IconUnitedHealthcare.png" id="uhc-logo" alt="United Healthcare logo" />
  <!-- optional: add a span title -->
  <span id="uhc-title">United Healthcare</span>
  </header>

  <div id="overlay">
    <img src="img/spinner.svg" id="spinner" alt="Loading report" />
  </div>

  <div id="report-container" style="height: 90vh;"></div>

  <!-- Inline script: fetch JSON, pick report, render as iframe -->
  <script>
  (async function() {
    const overlay   = document.getElementById("overlay");
    const container = document.getElementById("report-container");

    // 1. Which report? (?report=ProjectSummary)
    const params     = new URLSearchParams(window.location.search);
    const reportName = params.get("report");

    // 2. Load the JSON list
    let list;
    try {
      const resp = await fetch("reportList.json");
      if (!resp.ok) throw new Error("HTTP " + resp.status);
      list = await resp.json();
    } catch (err) {
      overlay.innerHTML = `<div style="color:red;padding:20px;">
        Failed to load report list:<br>${err.message}
      </div>`;
      return;
    }

    // 3. Pick the matching entry or default to the first
    let entry = reportName && list.find(r => r.name === reportName);
    if (!entry) entry = list[0];
    if (!entry || !entry.embedUrl) {
      overlay.innerHTML = `<div style="color:red;padding:20px;">
        No report found to embed
      </div>`;
      return;
    }

    // 4. Inject an iframe for the Publish-to-web URL
    const iframe = document.createElement("iframe");
    iframe.src            = entry.embedUrl;
    iframe.width          = "100%";
    iframe.height         = "100%";
    iframe.frameBorder    = "0";
    iframe.allowFullscreen= true;
    container.innerHTML   = "";         // clear spinner
    container.appendChild(iframe);
    overlay.style.display = "none";
  })();
  </script>
</body>
</html>
